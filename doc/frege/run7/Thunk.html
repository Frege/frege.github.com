<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_95) on Fri Mar 11 16:43:52 CET 2016 -->
<title>Thunk</title>
<meta name="date" content="2016-03-11">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Thunk";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../frege/run7/Lazy.D.html" title="class in frege.run7"><span class="strong">Prev Class</span></a></li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../index.html?frege/run7/Thunk.html" target="_top">Frames</a></li>
<li><a href="Thunk.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">frege.run7</div>
<h2 title="Class Thunk" class="title">Class Thunk&lt;R&gt;</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>frege.run7.Thunk&lt;R&gt;</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;R&gt;, java.util.concurrent.Callable&lt;R&gt;</dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">Thunk&lt;R&gt;</span>
extends java.lang.Object
implements <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;R&gt;</pre>
<div class="block"><p> A lazy value that can be shared and is updated with the evaluated value.</p>

 <p> Lazy values differ from proper values insofar as they need to know
 how to exactly evaluate themselves.
 This is the job of the <a href="../../frege/run7/Thunk.html#call()"><code>call()</code></a>. </p>

 <p> The functionality of <a href="../../frege/run7/Thunk.html#call()"><code>call()</code></a> is fixed through <tt>final</tt>
 and cannot be changed. It is in some sense the heart of the runtime, as it provides
 support for tail calls and lazy evaluation. </p>
 
 <p><a href="../../frege/run7/Thunk.html#call()"><code>call()</code></a> repeatedly invokes <a href="../../frege/run7/Lazy.html#call()"><code>Lazy.call()</code></a> until the returned value is 
 in <i>weak head normal form</i>, which is signalled by not being an instance of <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a>.
 In addition, the result is shared through 
 caching it in a private instance variable. Hence, instances of
 <a href="../../frege/run7/Thunk.html" title="class in frege.run7"><code>Thunk</code></a> are not immutable and this in turn requires synchronization.</p>

 <p> The caching of the evaluated value would not be strictly necessary, as
 repeated evaluation must always yield the same result. Experience shows,
 however, that re-evaluations are quite common, hence not caching the result
 would most likely cause even the simplest program to perform unacceptably bad.
 </p>

 <h3> Introduction of lazyness in frege compiled code </h3>

 <p> Thunk values are introduced at only 2 occasions: </p>

 <ol>
 <li>
 <p>  Thunk arguments of data constructors or functions. Take the following example: </p>
 <pre><code>
 -- the list of fibonacci numbers
 fibs = 0:1:zipWith (+) fibs (tail fibs)
 </code></pre>

 <p> The second argument of (:) must be lazy because its type is recursive. 
 Types of constructor arguments are said to be recursive, if they mention a type 
 that depends on the type of the constructed value.
 A type depends on itself and on types that mention it in at least one constructor argument. 
 </p>

 <p>Hence, the application of <tt>zipWith</tt> argument may appear in code like this:</p>
 <pre><code>
 new Thunk(() -> zipWith(plusFunc, fibs, tail(fibs));
 </code></pre>
 </li>
 <li>
 <p> Non-recursive tail calls. </p>
 <p> If the return value of a function is expressed as a function call,
 we call this a <em>tail call</em>. If a function tail-calls itself, this is
 <em>tail recursion</em>. Here are examples: </p>
 <pre>
 <code>
 even 0 = true
 even n = odd  (n-1)
 odd  0 = false
 odd  n = even (n-1)
 factorial n | n &gt;= 0 = helper 1 n where
    helper r 0 = r
    helper r n = helper (r*n) (n-1)
 </code>
 </pre>
 <p> Function "helper" is tail recursive and will be compiled to a while loop.
 Functions "factorial", "even" and "odd", however, employ tail calls.
 In "factorial", this is not a problem, it just sets up parameters for the
 very efficient "helper" function, thus we can expect a maximum stack depth of 2
 no matter what the value of "n" is.</p>
 <p> Things are different with "even" and "odd" that would need stack space
 proportional to the value of their argument if implemented naively.
 But frege functions may simply return their tail call in the form of
 a <a href="../../frege/run7/Thunk.html" title="class in frege.run7"><code>Thunk</code></a> object instead of actually evaluating it themselves. This way, a long
 series of tail calls can be converted to a while loop, see <a href="../../frege/run7/Thunk.html#call()"><code>call()</code></a>. </p>
 <p>Unfortunately, this does not work in every case. Take the even/odd exmple in a slightly
 changed form:</p>
 <pre>
 even 0 = true
 even 1 = false
 even n = odd  (n-1)
 odd  n = !(even n)
 </pre>
 This will very soon run out of stack space with greater n. To see why, imagine <tt>even 5</tt>
 had to be evaluated.
 <pre>
 even 5 = odd 4               by 3rd rule of even
 odd 4 = !(even 4)            by definition of odd
 !(even 4) = !(odd 3)         by 3rd rule of even
 !(odd 3)  = !(!(even 3))
 !(!(even 3)) = !(!(odd 2))
 !(!(odd 2))  = !(!(!(even 2)))
 !(!(!(even 2))) = !(!(!(odd 1)))
 !(!(!(odd 1))) = !(!(!(!(even 0))))
 !(!(!(!(even 0)))) = !(!(!(!true)))
 </pre>
 <p>
 Because ! must first know the value to negate it must evaluate its argument
 before it returns. Hence, evaluation of (odd n) results in n nested negations, i.e. in
 a stack depth of n.
 </p>
 <p>This effect happens always when the recursion is done indirectly in an
 argument of a strict function. Another well-known case is the naive implementation
 of a function that tells a lists's length:</p>
 <pre>
 naiveLength [] = 0
 naiveLength (_:as) = 1 + naiveLength as
 </pre>
 <p>Here, the recursion takes place in the 2nd argument of the addition.
 To add 1 to something, one must first know to what, hence the
 whole list must be consulted before even the first addition 
 can take place.</p>
 <p>Compare the better implementation:</p>
 <pre>
 length xs = helper xs 0
    where
       helper []     !count = count
       helper (_:as) !count = helper as (count+1)
 </pre>
 Here, only tail call recursion takes place and because counter is strict, the increment
 will be evaluated in each loop.
 </li>
 </ol></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="nested_classes_inherited_from_class_frege.run7.Lazy">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from interface&nbsp;frege.run7.<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a></h3>
<code><a href="../../frege/run7/Lazy.D.html" title="class in frege.run7">Lazy.D</a>&lt;<a href="../../frege/run7/Lazy.D.html" title="type parameter in Lazy.D">X</a>&gt;</code></li>
</ul>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;<a href="../../frege/run7/Thunk.html" title="type parameter in Thunk">R</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#eval">eval</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.Object</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#item">item</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazyemptyString">lazyemptyString</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Boolean&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazyFalse">lazyFalse</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Integer&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazyOne">lazyOne</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Boolean&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazyTrue">lazyTrue</a></strong></code>
<div class="block"> Some often used lazy values.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Integer&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazyTwo">lazyTwo</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Short&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazyUnit">lazyUnit</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;<a href="../../frege/runtime/Phantom.RealWorld.html" title="interface in frege.runtime">Phantom.RealWorld</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazyWorld">lazyWorld</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Integer&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazyZero">lazyZero</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colLast" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private </code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#Thunk()">Thunk</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private </code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#Thunk(frege.run7.Lazy)">Thunk</a></strong>(<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;<a href="../../frege/run7/Thunk.html" title="type parameter in Thunk">R</a>&gt;&nbsp;it)</code>
<div class="block"> Create a thunk from a <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a> value.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../frege/run7/Thunk.html" title="class in frege.run7">Thunk</a>&lt;<a href="../../frege/run7/Thunk.html" title="type parameter in Thunk">R</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#asThunk()">asThunk</a></strong>()</code>
<div class="block"> Tell if this is really a <a href="../../frege/run7/Thunk.html" title="class in frege.run7"><code>Thunk</code></a></div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../frege/run7/Thunk.html" title="type parameter in Thunk">R</a></code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#call()">call</a></strong>()</code>
<div class="block"> evaluate the <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a>, and update this Thunk, unless it is already evaluated.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) boolean</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#isEvaluated()">isEvaluated</a></strong>()</code>
<div class="block">tell if this Thunk is already evaluated.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Boolean&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazy(boolean)">lazy</a></strong>(boolean&nbsp;val)</code>
<div class="block">Make sure we have a <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a> value.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Byte&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazy(byte)">lazy</a></strong>(byte&nbsp;val)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Character&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazy(char)">lazy</a></strong>(char&nbsp;val)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Double&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazy(double)">lazy</a></strong>(double&nbsp;val)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Float&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazy(float)">lazy</a></strong>(float&nbsp;val)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Integer&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazy(int)">lazy</a></strong>(int&nbsp;val)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static &lt;X&gt;&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;X&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazy(frege.run7.Lazy)">lazy</a></strong>(<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;X&gt;&nbsp;val)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Long&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazy(long)">lazy</a></strong>(long&nbsp;val)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Short&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazy(short)">lazy</a></strong>(short&nbsp;val)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static &lt;X&gt;&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;X&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#lazy(X)">lazy</a></strong>(X&nbsp;val)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static &lt;R&gt;&nbsp;<a href="../../frege/run7/Thunk.html" title="class in frege.run7">Thunk</a>&lt;R&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#nested(frege.run7.Lazy)">nested</a></strong>(<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;R&gt;&gt;&nbsp;v)</code>
<div class="block"> The following creates a Thunk«B» and hence a Lazy«B»
 from something that is known to be Lazy«Lazy«B»».</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static &lt;X&gt;&nbsp;X</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#once(X,%20X)">once</a></strong>(X&nbsp;obj,
    X&nbsp;nul)</code>
<div class="block">Utility function to get some value and clearing it at the same time.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static &lt;R&gt;&nbsp;<a href="../../frege/run7/Thunk.html" title="class in frege.run7">Thunk</a>&lt;R&gt;</code></td>
<td class="colLast"><code><strong><a href="../../frege/run7/Thunk.html#shared(frege.run7.Lazy)">shared</a></strong>(<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;R&gt;&nbsp;v)</code>
<div class="block">Static form of the constructor</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="item">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>item</h4>
<pre>private volatile&nbsp;java.lang.Object item</pre>
</li>
</ul>
<a name="eval">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>eval</h4>
<pre>private&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;<a href="../../frege/run7/Thunk.html" title="type parameter in Thunk">R</a>&gt; eval</pre>
</li>
</ul>
<a name="lazyTrue">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazyTrue</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Boolean&gt; lazyTrue</pre>
<div class="block"><p> Some often used lazy values. </p></div>
</li>
</ul>
<a name="lazyFalse">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazyFalse</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Boolean&gt; lazyFalse</pre>
</li>
</ul>
<a name="lazyemptyString">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazyemptyString</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.String&gt; lazyemptyString</pre>
</li>
</ul>
<a name="lazyZero">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazyZero</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Integer&gt; lazyZero</pre>
</li>
</ul>
<a name="lazyOne">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazyOne</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Integer&gt; lazyOne</pre>
</li>
</ul>
<a name="lazyTwo">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazyTwo</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Integer&gt; lazyTwo</pre>
</li>
</ul>
<a name="lazyWorld">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazyWorld</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;<a href="../../frege/runtime/Phantom.RealWorld.html" title="interface in frege.runtime">Phantom.RealWorld</a>&gt; lazyWorld</pre>
</li>
</ul>
<a name="lazyUnit">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>lazyUnit</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Short&gt; lazyUnit</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="Thunk(frege.run7.Lazy)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>Thunk</h4>
<pre>private&nbsp;Thunk(<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;<a href="../../frege/run7/Thunk.html" title="type parameter in Thunk">R</a>&gt;&nbsp;it)</pre>
<div class="block"><p> Create a thunk from a <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a> value. </p>
 <p> On evaluation via <a href="../../frege/run7/Thunk.html#call()"><code>call()</code></a>, this Thunk will be updated with
 the result of evaluating the value. </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>it</code> - a lazy value. <b>This must never be null!</b></dd></dl>
</li>
</ul>
<a name="Thunk()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Thunk</h4>
<pre>private&nbsp;Thunk()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="asThunk()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>asThunk</h4>
<pre>public&nbsp;<a href="../../frege/run7/Thunk.html" title="class in frege.run7">Thunk</a>&lt;<a href="../../frege/run7/Thunk.html" title="type parameter in Thunk">R</a>&gt;&nbsp;asThunk()</pre>
<div class="block"><strong>Description copied from interface:&nbsp;<code><a href="../../frege/run7/Lazy.html#asThunk()">Lazy</a></code></strong></div>
<div class="block"><p> Tell if this is really a <a href="../../frege/run7/Thunk.html" title="class in frege.run7"><code>Thunk</code></a> </p></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../frege/run7/Lazy.html#asThunk()">asThunk</a></code>&nbsp;in interface&nbsp;<code><a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;<a href="../../frege/run7/Thunk.html" title="type parameter in Thunk">R</a>&gt;</code></dd>
<dt><span class="strong">Returns:</span></dt><dd></dd></dl>
</li>
</ul>
<a name="call()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>call</h4>
<pre>public final&nbsp;<a href="../../frege/run7/Thunk.html" title="type parameter in Thunk">R</a>&nbsp;call()</pre>
<div class="block"><p> evaluate the <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a>, and update this Thunk, unless it is already evaluated. </p></div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../frege/run7/Lazy.html#call()">call</a></code>&nbsp;in interface&nbsp;<code><a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;<a href="../../frege/run7/Thunk.html" title="type parameter in Thunk">R</a>&gt;</code></dd>
<dt><strong>Specified by:</strong></dt>
<dd><code>call</code>&nbsp;in interface&nbsp;<code>java.util.concurrent.Callable&lt;<a href="../../frege/run7/Thunk.html" title="type parameter in Thunk">R</a>&gt;</code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the evaluated value</dd><dt><span class="strong">See Also:</span></dt><dd><code>Callable.call()</code></dd></dl>
</li>
</ul>
<a name="isEvaluated()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isEvaluated</h4>
<pre>boolean&nbsp;isEvaluated()</pre>
<div class="block"><p>tell if this Thunk is already evaluated.</p></div>
<dl><dt><span class="strong">Returns:</span></dt><dd>true, if it is already evaluated, false otherwise</dd></dl>
</li>
</ul>
<a name="lazy(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazy</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Boolean&gt;&nbsp;lazy(boolean&nbsp;val)</pre>
<div class="block">Make sure we have a <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a> value.
 
 <p>This is, in a sense, the exact opposite of <a href="../../frege/run7/Thunk.html#call()"><code>call()</code></a>. 
 Whereas the latter evaluates a <a href="../../frege/run7/Thunk.html" title="class in frege.run7"><code>Thunk</code></a>, unless already evaluated,
 this method constructs a <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a> value unless it is statically known
 to be a <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a>. 
 </p>
 
 <p>Because all algebraic types implement <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a>, 
 this should create an extra wrapper for native values only.</p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>val</code> - some value</dd>
<dt><span class="strong">Returns:</span></dt><dd>If the argument is already <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a>, it is returned properly casted.
           Otherwise it is wrapped in a <a href="../../frege/run7/Box.html" title="class in frege.run7"><code>Box</code></a> and returned.</dd></dl>
</li>
</ul>
<a name="lazy(byte)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazy</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Byte&gt;&nbsp;lazy(byte&nbsp;val)</pre>
</li>
</ul>
<a name="lazy(short)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazy</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Short&gt;&nbsp;lazy(short&nbsp;val)</pre>
</li>
</ul>
<a name="lazy(char)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazy</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Character&gt;&nbsp;lazy(char&nbsp;val)</pre>
</li>
</ul>
<a name="lazy(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazy</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Integer&gt;&nbsp;lazy(int&nbsp;val)</pre>
</li>
</ul>
<a name="lazy(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazy</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Long&gt;&nbsp;lazy(long&nbsp;val)</pre>
</li>
</ul>
<a name="lazy(double)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazy</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Double&gt;&nbsp;lazy(double&nbsp;val)</pre>
</li>
</ul>
<a name="lazy(float)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazy</h4>
<pre>public static final&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;java.lang.Float&gt;&nbsp;lazy(float&nbsp;val)</pre>
</li>
</ul>
<a name="lazy(frege.run7.Lazy)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazy</h4>
<pre>public static final&nbsp;&lt;X&gt;&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;X&gt;&nbsp;lazy(<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;X&gt;&nbsp;val)</pre>
</li>
</ul>
<a name="lazy(java.lang.Object)">
<!--   -->
</a><a name="lazy(X)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazy</h4>
<pre>public static final&nbsp;&lt;X&gt;&nbsp;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;X&gt;&nbsp;lazy(X&nbsp;val)</pre>
</li>
</ul>
<a name="shared(frege.run7.Lazy)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shared</h4>
<pre>public static final&nbsp;&lt;R&gt;&nbsp;<a href="../../frege/run7/Thunk.html" title="class in frege.run7">Thunk</a>&lt;R&gt;&nbsp;shared(<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;R&gt;&nbsp;v)</pre>
<div class="block"><p>Static form of the constructor</p>

 <p>For   <a href="../../frege/run7/Thunk.html" title="class in frege.run7"><code>Thunk</code></a>s, this is the identity.</p>
 <p>Other <a href="../../frege/run7/Lazy.html" title="interface in frege.run7"><code>Lazy</code></a> instances are wrapped in a <a href="../../frege/run7/Thunk.html" title="class in frege.run7"><code>Thunk</code></a>, this makes them shared.</p></div>
<dl><dt><span class="strong">Returns:</span></dt><dd>a <a href="../../frege/run7/Thunk.html" title="class in frege.run7"><code>Thunk</code></a>, no matter what.</dd></dl>
</li>
</ul>
<a name="nested(frege.run7.Lazy)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nested</h4>
<pre>public static final&nbsp;&lt;R&gt;&nbsp;<a href="../../frege/run7/Thunk.html" title="class in frege.run7">Thunk</a>&lt;R&gt;&nbsp;nested(<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;<a href="../../frege/run7/Lazy.html" title="interface in frege.run7">Lazy</a>&lt;R&gt;&gt;&nbsp;v)</pre>
<div class="block"><p> The following creates a Thunk«B» and hence a Lazy«B»
 from something that is known to be Lazy«Lazy«B»». </p>
 
 <p>Now, the cast is justified for the reason that a Thunk«B» arranges for evaluation
 in such a way that a B will actually be returned. Hence, while Thunk«B» and Thunk«Lazy«B»»
 are indeed different types, it is the case that call() must never return a Lazy«B» 
 that is not also a B (like with algebraic values).</p>
 
 <p>We need this when two or more functions are mutually recursive, like in the 
 following scenario:</p>
 <pre>
        even 0 = true
  even 1 = false
  even n = odd (n-1)
  odd n = even (n-1)
 </pre>
 
 <p>In such cases, direct method calls would cause a StackOverflow on larger numbers.
 Hence, it is mandatory, that the result must be Lazy for all functions. 
 Now consider the case where odd() is about to call even(): it must return the same 
 value as even(n-1) without actually calling even(). Hence it should return something like:<p>
  
 <pre>return (Lazy«Boolean») (() -> even(n-1));</pre> 
 
 <p>but since the right hand side is already Lazy«Boolean» this doesn't type check. 
 Likewise</p>
 
 <pre>return (Lazy«Lazy«Boolean»») (() -> even(n-1));</pre>
 
 <p>is incommensurable with the return type, which is just Lazy«Boolean». Hence the
 solution is to embed the lambda in a Thunk:</p>
 
 <pre>return Thunk.«B»nested( (Lazy«Lazy«Boolean»») (() -> even(n-1)) );</pre>
 
 <p>thereby lowering the compile type lazyness of the result by one level.</p>
 <p>Furthermore, odd() can now be seen as a tail-call safe function, since it doesn't
 actually do a tail call, but just constructs the thunk.
 
 This, in turn, makes it now possible for even to call  odd(n-1) method directly, yet
 without evaluating the result. For, this will just give the nested thunk after a
 limited number of method calls (1, in this case), which is
 a lazy boolean and can be returned right away.</p>
 <p>An alternative to this method would be to have 3 categories of functions: strict ones, lazy ones and 
 double lazy ones. But this would dramatically complicate the code generator.</p></div>
</li>
</ul>
<a name="once(java.lang.Object,java.lang.Object)">
<!--   -->
</a><a name="once(X, X)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>once</h4>
<pre>public static final&nbsp;&lt;X&gt;&nbsp;X&nbsp;once(X&nbsp;obj,
         X&nbsp;nul)</pre>
<div class="block"><p>Utility function to get some value and clearing it at the same time.</p>
 <p>Use like</p>
 <code>
 Thunk.once(v, v = null)
 </code></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>obj</code> - the desired value, usually given as a nonfinal variable</dd><dd><code>nul</code> - this argument is ignored, usually used to assign null to the variable</dd>
<dt><span class="strong">Returns:</span></dt><dd>the first argument</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../frege/run7/Lazy.D.html" title="class in frege.run7"><span class="strong">Prev Class</span></a></li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../index.html?frege/run7/Thunk.html" target="_top">Frames</a></li>
<li><a href="Thunk.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
